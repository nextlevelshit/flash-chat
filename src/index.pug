doctype html
html(lang="en")
    head
        meta(charset="utf-8")
        meta(name="viewport" content="width=device-width, initial-scale=1")
        meta(name="theme-color" content="#3b82f6")
        meta(name="apple-mobile-web-app-capable" content="yes")
        meta(name="apple-mobile-web-app-status-bar-style" content="default")
        title Flash Chat - Private Encrypted Chat
        link(rel="manifest" href="/manifest.json")
        link(rel="icon" href="/favicon.ico")
        script(src="https://cdn.tailwindcss.com")
        script.
            tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            primary: '#3b82f6',
                            'primary-dark': '#1e40af',
                            surface: '#f8fafc',
                            'surface-dark': '#0f172a'
                        },
                        backdropBlur: {
                            xs: '2px'
                        }
                    }
                }
            }
        style.
            .glass {
                background: rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.2);
            }
            .glass-dark {
                background: rgba(15, 23, 42, 0.8);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.1);
            }
            .message-read::after {
                content: '‚úì‚úì';
                color: #3b82f6;
                font-size: 0.75rem;
                margin-left: 0.25rem;
            }
            .message-delivered::after {
                content: '‚úì';
                color: #6b7280;
                font-size: 0.75rem;
                margin-left: 0.25rem;
            }

    body(class="bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-slate-900 dark:to-slate-800 min-h-screen flex flex-col transition-colors duration-300")

        header(class="glass dark:glass-dark p-4 border-b border-white/20 dark:border-white/10")
            div(class="flex justify-between items-center max-w-4xl mx-auto")
                h1(class="text-xl font-bold text-slate-800 dark:text-white") Flash Chat
                div(class="flex gap-2 flex-wrap")
                    button#theme-toggle(class="px-3 py-2 rounded-lg bg-white/20 hover:bg-white/30 text-slate-700 dark:text-slate-200 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50" aria-label="Toggle theme")
                        span(class="sr-only") Toggle theme
                        | üåô
                    button#mode-toggle(class="px-3 py-2 rounded-lg bg-white/20 hover:bg-white/30 text-slate-700 dark:text-slate-200 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50" aria-label="Toggle chat mode")
                        | Signal
                    button#help-btn(class="px-3 py-2 rounded-lg bg-white/20 hover:bg-white/30 text-slate-700 dark:text-slate-200 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50" aria-label="Show help")
                        | ‚ùì Help
                    button#destroy-btn(class="px-3 py-2 rounded-lg bg-red-500/20 hover:bg-red-500/30 text-red-700 dark:text-red-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500/50" aria-label="Destroy all data")
                        | üóëÔ∏è Destroy
                    button#share-btn(class="px-3 py-2 rounded-lg bg-primary/20 hover:bg-primary/30 text-primary-dark dark:text-primary transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50" aria-label="Share conversation")
                        | üì§ Share

        dialog#welcome-dialog(class="backdrop:backdrop-blur-sm rounded-xl border-0 shadow-2xl max-w-2xl w-full mx-4 glass dark:glass-dark p-0")
            div(class="p-6")
                header(class="mb-6")
                    h2(class="text-2xl font-bold text-slate-800 dark:text-white mb-2") Welcome to Flash Chat
                    p(class="text-slate-600 dark:text-slate-400") Private conversations with client-side encryption

                section(class="mb-6")
                    h3(class="text-lg font-semibold text-slate-800 dark:text-white mb-3") How It Works
                    ol(class="list-decimal list-inside space-y-2 text-slate-600 dark:text-slate-400")
                        li Type your message and press Enter to send
                        li Messages are encrypted client-side with ephemeral keys
                        li Share conversations via secure URL links
                        li Switch between Signal and IRC interface modes
                        li Toggle between light and dark themes

                section(class="mb-6")
                    h3(class="text-lg font-semibold text-slate-800 dark:text-white mb-3") Privacy Features
                    div(class="space-y-2 text-slate-600 dark:text-slate-400")
                        p
                            strong(class="text-primary") End-to-End Encryption:
                            |  All messages are encrypted before leaving your device
                        p
                            strong(class="text-primary") No Server Storage:
                            |  Everything runs in your browser with no backend
                        p
                            strong(class="text-primary") Ephemeral Keys:
                            |  Each conversation uses unique encryption keys
                        p
                            strong(class="text-primary") Full Control:
                            |  You own your data and can delete everything anytime

                footer(class="flex justify-between items-center pt-4 border-t border-white/20 dark:border-white/10")
                    label(class="flex items-center gap-2 text-sm text-slate-600 dark:text-slate-400 cursor-pointer")
                        input#dont-show-again(type="checkbox" class="rounded border-gray-300 dark:border-gray-600 text-primary focus:ring-primary/50")
                        span Don't show this again
                    button#start-chatting(class="px-6 py-2 bg-primary hover:bg-primary-dark text-white rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50")
                        | Start Chatting

        main(class="flex-1 flex flex-col overflow-hidden max-w-4xl mx-auto w-full")
            div(class="flex-1 overflow-y-auto p-4")
                div#messages(class="messages space-y-3" role="log" aria-live="polite" aria-label="Chat messages")

            div(class="status-bar glass dark:glass-dark px-4 py-2 border-t border-white/20 dark:border-white/10")
                div(class="flex justify-between items-center text-xs text-slate-600 dark:text-slate-400 gap-4")
                    div(class="flex gap-4 flex-wrap")
                        span#sent-count Sent: 0
                        span#received-count Received: 0
                        span#last-update Last: Never
                        span#encryption-status üîí Encrypted
                    div(class="flex items-center gap-2")
                        span(class="text-xs") Share:
                        button#current-link(class="text-primary hover:text-primary-dark truncate max-w-xs text-left focus:outline-none focus:ring-2 focus:ring-primary/50" title="Click to copy share link")
                            | Loading...

        footer(class="p-4 border-t border-white/20 dark:border-white/10")
            form#message-form(class="flex gap-2 max-w-4xl mx-auto")
                input#message-input(type="text" placeholder="Type your message..." aria-label="Message input" autocomplete="off" class="flex-1 px-4 py-3 bg-white/50 dark:bg-slate-800/50 backdrop-blur-sm rounded-lg border border-white/20 dark:border-white/10 text-slate-800 dark:text-white placeholder-slate-500 dark:placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary/50 transition-all duration-200")
                button(type="submit" aria-label="Send message" class="px-6 py-3 bg-primary hover:bg-primary-dark text-white rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed")
                    | Send

        script(src="app.js")