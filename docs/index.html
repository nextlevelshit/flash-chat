<!DOCTYPE html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1"><title>Flash Chat</title><link rel=stylesheet href=/flash-chat/flash.d77a706c.css><body data-theme=dark data-mode=signal><header><h1>Flash Chat</h1><div class=controls><button id=theme-toggle>🌙</button><button id=mode-toggle>Signal</button><button id=help-btn>❓ Help</button><button id=destroy-btn>🗑️ Destroy</button><button id=share-btn>📋 Share</button></div></header><div class=modal id=welcome-screen><div class=modal-content><h2>Welcome to Flash Chat</h2><div class=welcome-section><h3>Usage Instructions</h3><ol><li>Type your message in the input field and press Enter or click Send<li>Share conversations by clicking the Share button or using the auto-generated link in the status bar<li>Switch between Signal and IRC interface modes using the mode toggle button<li>Clear all data permanently using the Destroy button<li>Toggle between dark and light themes using the theme button</ol></div><div class=welcome-section><h3>Key Features</h3><p><strong>Local Storage:</strong> All messages are stored in your browser's localStorage. No server required.<p><strong>Share via URL:</strong> Generate shareable links that contain your entire conversation history.<p><strong>Dual Interface:</strong> Switch between Signal-style bubbles and IRC-style linear chat.<p><strong>Theme Support:</strong> Toggle between dark and light themes.</div><div class=welcome-section><h3>Privacy &amp; Security</h3><p>Your messages never leave your device unless you explicitly share them via URL. The app works entirely offline after initial load.</div><div class=welcome-actions><button id=start-chatting>Start Chatting</button><label><input id=dont-show-again type=checkbox><span>Don't show this again</span></label></div></div></div><main id=chat-container><div class=messages role=log aria-live=polite aria-label="Chat messages"></div><div class=status-bar><div class=status-info><span id=sent-count>Sent: 0</span><span id=received-count>Received: 0</span><span id=last-update>Last: Never</span><span id=sync-status>Synced: ✓</span></div><div class=share-link id=current-link title="Click to copy">Loading...</div></div></main><footer><form id=message-form><input id=message-input placeholder="Type message..." aria-label="Message input"><button>Send</button></form></footer><script>function getUserId(){let e=localStorage.getItem("flash_user_id");return e||(e="user_"+Math.random().toString(36).substr(2,8),localStorage.setItem("flash_user_id",e)),e}let currentUserId=getUserId(),stats={sent:0,received:0,lastUpdate:null,lastSync:Date.now()};function showWelcomeScreen(){document.getElementById("welcome-screen").style.display="flex"}function hideWelcomeScreen(){document.getElementById("welcome-screen").style.display="none"}function checkWelcomeScreen(){localStorage.getItem("flash_seen_welcome")||showWelcomeScreen()}function destroyAllData(){confirm("Are you sure you want to permanently delete all messages and data? This cannot be undone.")&&(Object.keys(localStorage).forEach(e=>{(e.startsWith("msg_")||e.startsWith("flash_"))&&localStorage.removeItem(e)}),stats={sent:0,received:0,lastUpdate:null,lastSync:Date.now()},document.querySelector(".messages").innerHTML="",updateStatusDisplay(),updateShareLink(),showWelcomeScreen(),alert("All data has been destroyed."))}function updateShareLink(){let e=btoa(JSON.stringify(Object.keys(localStorage).filter(e=>e.startsWith("msg_")).sort().map(e=>JSON.parse(localStorage.getItem(e))))),t=`${window.location.origin}${window.location.pathname}?data=${e}`,n=document.getElementById("current-link");n.textContent=t,n.title="Click to copy: "+t,navigator.clipboard.writeText(t).catch(e=>{console.warn("Could not copy to clipboard:",e)}),stats.lastSync=Date.now(),updateStatusDisplay()}function updateStatusDisplay(){document.getElementById("sent-count").textContent=`Sent: ${stats.sent}`,document.getElementById("received-count").textContent=`Received: ${stats.received}`;let e=stats.lastUpdate?new Date(stats.lastUpdate).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Never";document.getElementById("last-update").textContent=`Last: ${e}`;let t=new Date(stats.lastSync).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});document.getElementById("sync-status").textContent=`Synced: ${t}`}function calculateStats(){let e=Object.keys(localStorage).filter(e=>e.startsWith("msg_")).map(e=>JSON.parse(localStorage.getItem(e)));stats.sent=e.filter(e=>e.userId===currentUserId).length,stats.received=e.filter(e=>e.userId!==currentUserId).length,stats.lastUpdate=e.length>0?Math.max(...e.map(e=>e.timestamp)):null}function loadFromURL(){let e=new URLSearchParams(window.location.search).get("data");if(e)try{JSON.parse(atob(e)).forEach(e=>{let t=`msg_${e.timestamp}`;localStorage.getItem(t)||localStorage.setItem(t,JSON.stringify(e))}),window.history.replaceState({},"",window.location.pathname)}catch(e){console.error("Invalid share data")}}function generateShareURL(){let e=btoa(JSON.stringify(Object.keys(localStorage).filter(e=>e.startsWith("msg_")).sort().map(e=>JSON.parse(localStorage.getItem(e))))),t=`${window.location.origin}${window.location.pathname}?data=${e}`;navigator.clipboard.writeText(t).then(()=>{let e=document.getElementById("share-btn"),t=e.textContent;e.textContent="✅ Copied!",setTimeout(()=>e.textContent=t,2e3)})}let themeToggle=document.getElementById("theme-toggle"),modeToggle=document.getElementById("mode-toggle"),helpBtn=document.getElementById("help-btn"),destroyBtn=document.getElementById("destroy-btn"),shareBtn=document.getElementById("share-btn"),shareLinkElement=document.getElementById("current-link"),startChattingBtn=document.getElementById("start-chatting"),dontShowAgainCheckbox=document.getElementById("dont-show-again"),body=document.body;themeToggle.addEventListener("click",()=>{let e=body.dataset.theme;body.dataset.theme="dark"===e?"light":"dark",themeToggle.textContent="dark"===e?"☀️":"\uD83C\uDF19",savePreferences()}),modeToggle.addEventListener("click",()=>{let e=body.dataset.mode;body.dataset.mode="irc"===e?"signal":"irc",modeToggle.textContent="irc"===e?"Signal":"IRC",savePreferences(),reRenderMessages()}),helpBtn.addEventListener("click",showWelcomeScreen),destroyBtn.addEventListener("click",destroyAllData),shareBtn.addEventListener("click",generateShareURL),startChattingBtn.addEventListener("click",()=>{dontShowAgainCheckbox.checked&&localStorage.setItem("flash_seen_welcome","true"),hideWelcomeScreen()}),shareLinkElement.addEventListener("click",()=>{navigator.clipboard.writeText(shareLinkElement.textContent).then(()=>{let e=shareLinkElement.textContent;shareLinkElement.textContent="✅ Copied!",setTimeout(()=>shareLinkElement.textContent=e,1500)})});let form=document.getElementById("message-form"),input=document.getElementById("message-input"),messages=document.querySelector(".messages");function addMessage(e,t){let n=Date.now(),a={text:e,timestamp:n,userId:t};localStorage.setItem(`msg_${n}`,JSON.stringify(a)),renderMessage(a),t===currentUserId?stats.sent++:stats.received++,stats.lastUpdate=n,updateShareLink()}function renderMessage(e){let t=document.createElement("div"),n=e.userId===currentUserId;t.className=`message ${n?"current-user":"other-user"}`,t.dataset.userId=e.userId;let a=new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});"irc"===document.body.dataset.mode?t.innerHTML=`<span class="timestamp">[${a}]</span> <span class="sender">&lt;${e.userId}&gt;</span> <span class="text">${e.text}</span>`:t.innerHTML=`<div class="bubble"><span class="text">${e.text}</span><span class="time">${a}</span></div>`,messages.appendChild(t),messages.scrollTop=messages.scrollHeight}function reRenderMessages(){messages.innerHTML="",Object.keys(localStorage).filter(e=>e.startsWith("msg_")).sort().forEach(e=>{renderMessage(JSON.parse(localStorage.getItem(e)))})}function loadPreferences(){let e=JSON.parse(localStorage.getItem("flash_prefs")||"{}");document.body.dataset.theme=e.theme||"dark",document.body.dataset.mode=e.mode||"signal",document.getElementById("theme-toggle").textContent="light"===e.theme?"☀️":"\uD83C\uDF19",document.getElementById("mode-toggle").textContent="irc"===e.mode?"IRC":"Signal"}function savePreferences(){let e={theme:document.body.dataset.theme,mode:document.body.dataset.mode};localStorage.setItem("flash_prefs",JSON.stringify(e))}form.addEventListener("submit",e=>{e.preventDefault();let t=input.value.trim();t&&(addMessage(t,currentUserId),input.value="")}),loadFromURL(),loadPreferences(),calculateStats(),reRenderMessages(),updateShareLink(),checkWelcomeScreen();</script>